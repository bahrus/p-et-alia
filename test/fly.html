<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
      <!-- Use experimental import maps -->
      <script defer src="../node_modules/es-module-shims/dist/es-module-shims.js"></script>
      <style>
        [gameover]::after{
          content: 'She died'
        }
        [gameover]{
          display:none;
        }
        [gameover][err="true"]{
          display:block;
          color:red;
        }
      </style>
      <div>There was an old lady who swallowed a fly;</div>
      <p-d on=foo to=[-lhs] val=target.textContent m=1></p-d>
      <if-diff disabled if -lhs equals rhs="There was an old lady who swallowed a fly;" data-key-name=swallowedFly></if-diff>
      <p-d on=value-changed to=[-why] val=target.value as-attr></p-d>
      <div data-swallowed-fly=0>
        <template>
          <button id=button1 disabled -why>I don't know why she swallowed a fly - Perhaps she'll die!</button>
          <p-d on=click to=[-err] val=why as-attr skip-init m=1></p-d>
          <div -err gameover></div>
        </template>
      </div>
      
      <button id=button2 disabled data-err=false>There was an old lady who swallowed a spider;</button>
      <p-d on=click to=[-err] val=target.dataset.err as-attr skip-init m=1></p-d>
      <div -err gameover err=true></div>
      <script type=module-shim>
        import {waitForAttributeChange} from 'trans-render/waitForAttributeChange.js';
        waitForAttributeChange(button2, 'disabled').then(() =>{
          button2.click();
        })
      </script>

      <div disabled id=wriggle1></div>
      <p-d on=wriggle-event to=[-text-content] val=target.myProp.subProp fire-event="why-spider" m=1 skip-init></p-d>
      <script  type=module-shim>
        import {waitForAttributeChange} from 'trans-render/waitForAttributeChange.js';
        waitForAttributeChange(wriggle1, 'disabled').then(() =>{
          wriggle1.myProp ={
            subProp: 'That wriggled and jiggled and tickeled inside her!'
          };
          wriggle1.dispatchEvent(new CustomEvent('wriggle-event'));
        })
      </script>
      <div -text-content data-spider-reason="She swallowed the spider to catch the fly;"></div>
      <p-d on="why-spider" to=[-text-content] val=target.dataset.spiderReason m=1 skip-init></p-d>
      <div -text-content></div>
      <script type="importmap-shim">
      {
        "imports": {
          "xtal-element/": "../node_modules/xtal-element/",
          "trans-render/": "../node_modules/trans-render/",
          "p-d": "../p-d.js"
        }
      }
      </script>
      <script  type="module-shim">
          import '../p-d.js';
          import '../node_modules/if-diff/if-diff.js';
      </script>
</body>
</html>