import{P}from"./p.js";import{define}from"trans-render/define.js";import{NavDown}from"xtal-element/NavDown.js";const m="m",from="from";export class PD extends P{constructor(){super(...arguments),this._pdNavDown=null,this._m=1/0,this._iIP=!1}static get is(){return"p-d"}get m(){return this._m}set m(t){this.attr(m,t.toString())}get from(){return this._from}set from(t){this.attr(from,t)}static get observedAttributes(){return super.observedAttributes.concat([m,from])}pass(t){this._lastEvent=t,this.attr("pds","🌩️");const s=this.applyProps(this._pdNavDown);this.attr("pds","👂"),this.attr("mtch",s.toString())}getMatches(t){return t.matches}applyProps(t){if(this._iIP)return 0;const s=this.getMatches(t);return s.forEach(s=>{t._inMutLoop&&"1"!==s.dataset.__pdWIP||this.setVal(this._lastEvent,s)}),s.length}attributeChangedCallback(t,s,r){switch(t){case m:null!==r&&(this._m=parseInt(r));break;case from:this._from=r;break;default:super.attributeChangedCallback(t,s,r)}}newNavDown(){const t=this.applyProps.bind(this),s=void 0===this._from?this:this.closest(this._from);return new NavDown(s,this.to,t,this.m)}connectedCallback(){this.propUp([m,from]),this.attr("pds","📞"),this.to||(this.to="*",this.m=1);const t=this.newNavDown();t.ignore="p-d,p-d-x,p-d-r,script",this._iIP=!0,t.init(),this._iIP=!1,this._pdNavDown=t,super.connectedCallback()}}define(PD);